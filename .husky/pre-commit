#!/bin/bash

# Define the JSON file to store the build version
json_file="build.json"

# Get current date and time in YYYY-MM-DD HH:MM:SS format
current_date=$(date +"%Y-%m-%d %H:%M:%S")

# Check if the JSON file exists
if [[ -f $json_file ]]; then
    # Extract the date and version from the JSON file
    last_version=$(grep "version" $json_file | awk -F'[ :]' '{print $NF}' | tr -d ',')
    new_version=$((last_version + 1))
else
    # Initialize with version 1 if the file doesn't exist
    new_version=1
fi

# Create or overwrite the JSON file with the new date and version
echo '{
  "date": "'"$current_date"'",
  "version": '"$new_version"'
}' > $json_file

# Add the JSON file to the commit
git add $json_file

# Allow the commit to proceed
exit 0

